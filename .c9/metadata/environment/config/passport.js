{"filter":false,"title":"passport.js","tooltip":"/config/passport.js","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":23,"column":2},"action":"insert","lines":["const JtwStrategy = require('passport-jwt').Strategy;","const ExtractJwt = require('passport-jwt').ExtractJwt;","const mongoose = require('mongoose');","const User = mongoose.model('users');","const keys = require('../config/keys');","","const opts = {};","opts.jwtFromRequest = ExtractJwt.fromAuthHeaderAsBearerToken();","opts.secretOrKey = keys.secretOrKey;","","module.exports = passport => {","    passport.use(","        new JtwStrategy(opts, (jwt_payload, done) => {","            User.findById(jwt_payload)","                .then(user => {","                    if (user) {","                        return done(null, user);","                    }","                    return done(null, false);","                })","                .catch(err => console.log(err));","        })","    );","};"],"id":1}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":23,"column":2},"end":{"row":23,"column":2},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1530293300829,"hash":"eb12a882fb5e05ab1a750d8e98f02d2096510635"}